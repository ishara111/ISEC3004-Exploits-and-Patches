# Buffer Over Read Exploitation:

Something about the program / Hint:

- Two user groups 1. user 2. admin
- Normal user gets a 3-length password/pin
- User password/PIN = 456
- Each user group has their documents according to its user privilege.
         User- user document with 4 pages.
         Admin- admin document with 4 pages.

Target=> get admin password/PIN 
                  Read admin documents.

Method of exploitation -> buffer over reading


How to achieve
  -The program contains 2 buffer bugs.
  -Try giving a password larger than the expected length.
  -Try giving a document length to read larger than the pages it contains.


App Functionality:

The program has two main functions.
1. It presents a log in screen to the user where it asks for the TYPE of the user and the relavant password. The username and password is hardcoded so the person logging in must know if beforehand. The admin password is "123" and the user password is "456". The user can choose whether to log in as an Admin or a User and then provide the relavant password.
2. The user can read a character array (which we assume to be a text document). If you are logged in as a user it shows the user document, and if you are logged in as an admin it shows the admin document. The logged in user can specify how much pages they want to read, and read the given amount of pages. For the sake of the demonstration the text file has been divided into pages such as "upage1|upage2|upage3|upage4|" and for the admin "ADMIN1|ADMIN2|ADMIN3|ADMIN4|"

The Bug:

This program is vulnerable to the Buffer Overread bug. The vulnerability is present in two places.
1. In the login screen where the user can overflow the array asking for the user password. This way the attacker can also get the admin password, since that is stored in a buffer adjacent to the user password. The user password has 3 characters, and when the user provides a value larger than 3 (eg: FFFFFFFF) it overreads the admin password buffer and shows the admin password as well.
2. A regular user can read pages of the Admin document as well. This is done by providing a value larger than the size of the user_document array when the program asks how much pages the user wants to read. The size of the user_document[] has been divided into 4 pages, so the moment the user enters a value larger than 4 it will read the admin pages from the adjacent document as well.
